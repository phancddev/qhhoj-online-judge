{% extends "base.html" %}
{% block js_media %}
    <script src="{{ static('libs/tablesorter.js') }}" type="text/javascript"></script>
    <script type="text/javascript">
        $(function () {
            $('.organization-table').tablesorter({sortList: [[1, 1]]});
        });
    </script>
{% endblock %}

{% block title_ruler %}{% endblock %}

{% block title_row %}
    {% set tab = 'organizations' %}
    {% include "organization/list-tabs.html" %}
{% endblock %}

{% macro org_table(name, queryset) %}
    <h3 class="text-2xl font-bold mb-4">{{ name }}</h3>
    <div class="overflow-x-auto">
        <table class="organization-table table w-full text-lg text-left text-gray-500">
            <thead class="text-xl text-white uppercase bg-primary border">
                <tr>
                    <th scope="col" class="problem-code px-4 py-3 border" style="width:70%">{{ _('Name') }}</th>
                    <th scope="col" class="problem-code px-4 py-3 border text-center" style="width:15%">{{ _('Points') }}</th>
                    <th scope="col" class="problem-code px-4 py-3 border text-center">{{ _('Members') }}</th>
                </tr>
            </thead>
            <tbody>
            {% for org in queryset %}
                <tr class="border hover:bg-light-blue-pink-gradient">
                    <td class="organization-name font-bold text-gray-900 whitespace-nowrap border"><a href="{{ org.get_absolute_url() }}">{{ org.name }}</a></td>
                    <td class="text-gray-900 whitespace-nowrap border text-center"><a href="{{ org.get_users_url() }}">{{ org.performance_points|floatformat(2) }}</a></td>
                    <td class="text-gray-900 whitespace-nowrap border text-center"><a href="{{ org.get_users_url() }}">{{ org.member_count }}</a></td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
        <div class="mb-10"></div>
    </div>
{% endmacro %}

{% block body %}
    <div class="content-description">
        {% if request.user.is_authenticated %}
            {% with orgs=request.profile.organizations.all() %}
                {% if orgs %}
                    {{ org_table(_('Your organizations'), orgs) }}
                {% endif %}
            {% endwith %}
        {% endif %}
        {{ org_table(_('All organizations'), organizations) }}
    </div>
{% endblock %}
